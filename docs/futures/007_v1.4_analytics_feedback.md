# Analytics & Customer Feedback System

> **Versão Target:** V1.4-1.5
> **Status:** ⏳ Pendente
> **Owner:** Unassigned
> **Estimativa:** 35h

---

## Descrição

Sistema de analytics avançado com dashboards Grafana/Metabase, tracking de SLA por empresa, e sistema de feedback do cliente para medir satisfação (CSAT/NPS).

---

## Passos de Implementação

### 1. Customer Feedback System (12h)

- [ ] `src/models/feedback.py` - Modelos de feedback
- [ ] `src/api/feedback_routes.py` - Endpoints
- [ ] Envio automático de pesquisa pós-resolução
- [ ] Cálculo de CSAT e NPS scores

**Feedback Schema:**
```javascript
{
  ticket_id: ObjectId,
  customer_id: ObjectId,
  rating: 1-5,
  comment: String,
  created_at: DateTime
}
```

### 2. Dashboards Grafana/Metabase (15h)

- [ ] Setup Grafana ou Metabase
- [ ] Conexão com MongoDB
- [ ] Dashboards:
  - Tickets por dia/semana/mês
  - Resolution time médio
  - CSAT/NPS trends
  - Agent performance
  - Channel breakdown

### 3. SLA Tracking (8h)

- [ ] `src/models/sla.py` - Configuração de SLA
- [ ] `src/utils/sla_checker.py` - Verificação de SLA
- [ ] Alertas de SLA breach
- [ ] Relatórios de SLA compliance

**SLA Config:**
```javascript
{
  company_id: ObjectId,
  first_response_minutes: 15,
  resolution_hours: 24,
  business_hours_only: true
}
```

---

### 4. Testes

- [ ] Unit tests para cálculos de métricas
- [ ] Integration tests para feedback flow

### 5. Documentação

- [ ] `docs/ANALYTICS.md` - Guia de métricas
- [ ] Setup guide para Grafana/Metabase

### 6. Infraestrutura

- [ ] Grafana/Metabase deployment
- [ ] Scheduled jobs para agregação de métricas

---

## Métricas Principais

| Métrica | Descrição | Cálculo |
|---------|-----------|---------|
| CSAT | Customer Satisfaction | (4-5 ratings) / total × 100 |
| NPS | Net Promoter Score | %Promoters - %Detractors |
| FRT | First Response Time | Média de tempo até primeira resposta |
| Resolution Time | Tempo de resolução | Média de tempo até fechamento |
| SLA Compliance | % dentro do SLA | Tickets OK / Total × 100 |

---

## Dependências

- V1.2 completo (Dashboard React)
- Sistema de tickets estável

---

## Referências

- [Grafana](https://grafana.com/)
- [Metabase](https://www.metabase.com/)
